{
  "$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
  "name": "TaskJuggler",
  "scopeName": "source.taskjuggler",
  "patterns": [
    { "include": "#comments" },
    { "include": "#strings" },
    { "include": "#properties" },
    { "include": "#reports" },
    { "include": "#report-keywords" },
    { "include": "#attributes" },
    { "include": "#functions" },
    { "include": "#operators" },
    { "include": "#macros" },
    { "include": "#identifiers" },
    { "include": "#dates" },
    { "include": "#numbers" },
    { "include": "#constants" },
    { "include": "#special-markers" }
  ],
  "repository": {
    "comments": {
      "patterns": [
        {
          "name": "comment.block.taskjuggler",
          "begin": "/\\*",
          "end": "\\*/",
          "captures": {
            "0": { "name": "punctuation.definition.comment.taskjuggler" }
          }
        },
        {
          "name": "comment.line.number-sign.taskjuggler",
          "match": "#.*$",
          "captures": {
            "0": { "name": "punctuation.definition.comment.taskjuggler" }
          }
        }
      ]
    },
    "strings": {
      "patterns": [
        {
          "name": "string.quoted.double.taskjuggler",
          "begin": "\"",
          "end": "\"",
          "patterns": [
            {
              "name": "constant.character.escape.taskjuggler",
              "match": "\\\\."
            },
            { "include": "#macros" }
          ]
        },
        {
          "name": "string.quoted.single.taskjuggler",
          "begin": "'",
          "end": "'",
          "patterns": [
            {
              "name": "constant.character.escape.taskjuggler",
              "match": "\\\\."
            }
          ]
        },
        {
          "name": "string.unquoted.heredoc.taskjuggler",
          "begin": "-8<-",
          "end": "->8-"
        }
      ]
    },
    "properties": {
      "patterns": [
        {
          "name": "storage.type.property.taskjuggler",
          "match": "\\b(account|copyright|currency|export|extend|flags|include|includejournalentry|leave|limits|macro|navigator|nikureport|now|project|projectid|projectids|rate|resource|scenario|shift|supplement|tagfile|task|timezone|trackingscenario|workinghours|yearlyworkingdays)\\b"
        }
      ]
    },
    "reports": {
      "patterns": [
        {
          "name": "support.class.report.taskjuggler",
          "match": "\\b(accountreport|csvaccountreport|csvresourcereport|csvtaskreport|export|htmlaccountreport|htmlmonthlycalendar|htmlresourcereport|htmlstatusreport|htmltaskreport|htmltimesheet|htmlweeklycalendar|icalreport|navigator|nikureport|resourcereport|statussheetreport|taskreport|textreport|timesheetreport|tracereport|xmlreport)\\b"
        }
      ]
    },
    "report-keywords": {
      "patterns": [
        {
          "name": "keyword.other.report.taskjuggler",
          "match": "\\b(accumulate|balance|barlabels|caption|celltext|cellurl|center|columns|end|epilog|formats|halign|headline|header|hidejournalentry|hideresource|hidetask|journalattributes|journalmode|left|loadunit|maxeffort|notimestamp|opennodes|period|prolog|properties|right|rollupaccount|rollupresource|rolluptask|scenarios|sortaccounts|sortjournalentries|sortresources|sorttasks|start|taskattributes|title|tree|valign|version)\\b"
        }
      ]
    },
    "attributes": {
      "patterns": [
        {
          "name": "entity.name.function.attribute.taskjuggler",
          "match": "\\b(account|accountprefix|accountroot|actual|adopt|aggregate|alert|alertlevels|allocate|alternative|annualleave|author|auxdir|balance|baseline|barlabels|booking|caption|cellcolor|celltext|cellurl|charge|chargeset|complete|context|copyright|cost|credit|currency|currencyformat|dailymax|dailyworkinghours|date|depends|disabled|duration|efficiency|effort|email|enabled|end|endcredit|endbuffer|epilog|export|extend|fail|familyname|fees|flags|footer|formats|firstname|headurl|headline|height|hideaccount|hidejournalentry|hideresource|hidetask|id|import|include|includejournalentry|inherit|interval|journalentry|journalmode|label|leave|length|limits|loadunit|managers|mandatory|maxeffort|maxend|maxstart|milestone|mineffort|minend|minstart|name|nationalholiday|navigator|newpage|nikename|note|now|numberformat|opennodes|pathcriteria|period|persistent|precedes|priority|prolog|projectid|projectids|purge|rate|reference|responsible|resource|resourceroot|revenue|scenario|scenarios|scheduling|selfcontained|shift|shifts|shorttitle|sortaccounts|sortjournalentries|sortresources|sorttasks|start|startbuffer|startcredit|statusnote|supplement|summary|tagfile|task|taskprefix|taskroot|teamslot|timeformat|timezone|timingresolution|title|trackingscenario|tree|vacation|version|warn|weekdays|weekend|weekstartsmonday|weekstartssunday|width|workinghours|yearlyworkingdays)\\b"
        }
      ]
    },
    "functions": {
      "patterns": [
        {
          "name": "support.function.taskjuggler",
          "match": "\\b(absolut|and|before|containssubstring|date|hasalert|hasresource|hierarchdown|hierarchup|isactive|isactualallocate|ischildof|isdutyof|isfeatureof|isleaf|ismilestone|isongoing|isplannedallocate|isresource|isresponsibilityof|istask|not|or|plan|treelevel|year)\\b"
        }
      ]
    },
    "operators": {
      "patterns": [
        {
          "name": "keyword.operator.logical.taskjuggler",
          "match": "(&|\\||~|!)"
        },
        {
          "name": "keyword.operator.comparison.taskjuggler",
          "match": "(=|<|>|<=|>=|!=|==)"
        },
        {
          "name": "keyword.operator.arithmetic.taskjuggler",
          "match": "(\\+|-|\\*|/|%)"
        },
        {
          "name": "keyword.operator.dependency.taskjuggler",
          "match": "(!+)"
        }
      ]
    },
    "macros": {
      "patterns": [
        {
          "name": "variable.other.macro.taskjuggler",
          "match": "\\$\\{[^}]+\\}"
        },
        {
          "name": "variable.other.envvar.taskjuggler",
          "match": "\\$\\([^)]+\\)"
        }
      ]
    },
    "identifiers": {
      "patterns": [
        {
          "name": "variable.other.taskjuggler",
          "match": "\\b[a-zA-Z_][a-zA-Z0-9_]*\\b"
        },
        {
          "name": "variable.other.absolute.taskjuggler",
          "match": "!+[a-zA-Z_][a-zA-Z0-9_.]*"
        }
      ]
    },
    "dates": {
      "patterns": [
        {
          "name": "constant.numeric.date.taskjuggler",
          "match": "\\b\\d{4}-\\d{2}-\\d{2}(-\\d{2}:\\d{2}(:\\d{2})?)?(-[A-Z]{3,4})?\\b"
        },
        {
          "name": "constant.numeric.time.taskjuggler",
          "match": "\\b\\d{1,2}:\\d{2}(:\\d{2})?\\b"
        }
      ]
    },
    "numbers": {
      "patterns": [
        {
          "name": "constant.numeric.percentage.taskjuggler",
          "match": "\\b\\d+(\\.\\d+)?%\\b"
        },
        {
          "name": "constant.numeric.duration.taskjuggler",
          "match": "\\b\\d+(\\.\\d+)?(min|h|d|w|m|y)\\b"
        },
        {
          "name": "constant.numeric.float.taskjuggler",
          "match": "\\b\\d+\\.\\d+\\b"
        },
        {
          "name": "constant.numeric.integer.taskjuggler",
          "match": "\\b\\d+\\b"
        }
      ]
    },
    "constants": {
      "patterns": [
        {
          "name": "constant.language.boolean.taskjuggler",
          "match": "\\b(on|off|yes|no|true|false)\\b"
        },
        {
          "name": "constant.language.builtin.taskjuggler",
          "match": "\\b(projectstart|projectend|now|today|plan|actual|ABSOLUTE_ID|CSV|HTML|MSP|TJSP|TJP|XML)\\b"
        },
        {
          "name": "constant.language.schedule.taskjuggler",
          "match": "\\b(alap|asap|length|duration|startstart|startend|endstart|endend)\\b"
        },
        {
          "name": "constant.language.selector.taskjuggler",
          "match": "\\b(maxloaded|minloaded|minallocated|order|random|min|max)\\b"
        },
        {
          "name": "constant.language.weekday.taskjuggler",
          "match": "\\b(mon|tue|wed|thu|fri|sat|sun|monday|tuesday|wednesday|thursday|friday|saturday|sunday)\\b"
        },
        {
          "name": "constant.numeric.color.taskjuggler",
          "match": "#[0-9A-Fa-f]{3,6}\\b"
        }
      ]
    },
    "special-markers": {
      "patterns": [
        {
          "name": "keyword.other.milestone.taskjuggler",
          "match": "\\bmilestone\\b"
        },
        {
          "name": "punctuation.definition.block.taskjuggler",
          "match": "[{}\\[\\]]"
        },
        {
          "name": "punctuation.separator.taskjuggler",
          "match": "[,;]"
        }
      ]
    }
  }
}
